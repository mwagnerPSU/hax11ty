import{SimpleColors as e}from"../../../simple-colors/simple-colors.js";import{html as s,css as t}from"../../../../lit/index.js";import{autorun as a,toJS as r}from"../../../../mobx/dist/mobx.esm.js";import{store as i}from"./AppHaxStore.js";import{varGet as p}from"../../../utils/utils.js";import"./app-hax-site-bar.js";import"./app-hax-site-details.js";export class AppHaxSearchResults extends e{static get tag(){return"app-hax-search-results"}constructor(){super(),this.searchItems=[],this.displayItems=[],this.searchTerm="",this.dark=!1,a((()=>{this.searchTerm=r(i.searchTerm)})),a((()=>{this.dark=r(i.darkMode)})),a((()=>{const e=r(i.manifest);e&&e.items&&(this.searchItems=r(i.manifest.items),this.displayItems=[...this.searchItems])}))}static get properties(){return{...super.properties,searchTerm:{type:String,reflect:!0},searchItems:{type:Array},displayItems:{type:Array}}}updated(e){super.updated&&super.updated(e),e.forEach(((e,s)=>{"searchTerm"===s&&(this.displayItems=this.searchItems.filter((e=>!!(e.title.toLowerCase().includes(this.searchTerm.toLowerCase())||e.description.toLowerCase().includes(this.searchTerm.toLowerCase())||e.author.toLowerCase().includes(this.searchTerm.toLowerCase())||e.slug.toLowerCase().includes(this.searchTerm.toLowerCase())))))}))}static get styles(){return[...super.styles,t`
        :host {
          overflow: hidden;
        }
        ul, li {
          margin: 0;
          padding: 0;
          list-style: none;
        }
        app-hax-site-bar {
          margin: 8px 0;
        }
        
        @media (max-width: 800px) {
          app-hax-site-bar {
            --main-banner-width: 60vw;
          }
        }
        @media (max-width: 400px) {
          app-hax-site-bar {
            --main-banner-width: 90vw;
          }
        }
        span[slot="band"] {
          height: 48px;
          overflow: hidden;
          text-overflow: ellipsis;
          margin-bottom: 8px;
        }
      `]}render(){return s`
      <ul id="results">
        ${this.displayItems.map((e=>s`<li>
              <app-hax-site-bar
                @opened-changed="${this.openedChanged}"
                ?dark="${this.dark}"
                accent-color="${p(e,"metadata.theme.variables.cssVariable","orange").replace("--simple-colors-default-theme-","").replace("-7","")}"
                icon="${p(e,"metadata.theme.variables.icon","icons:home")}"
                icon-link="${"https://iam.hax.psu.edu"+e.slug}"
                >
                <span slot="heading">${e.title}</span>
                <span slot="subHeading">${e.author}</span>
                <span slot="band">${e.description}</span>
                <app-hax-site-details slot="band"></app-hax-site-details>
              </app-hax-site-bar>
            </li>`))}
      </ul>
    `}openedChanged(e){e.detail.value?this.shadowRoot.querySelector("app-hax-site-details").removeAttribute("tabindex"):this.shadowRoot.querySelector("app-hax-site-details").setAttribute("tabindex","-1")}}customElements.define(AppHaxSearchResults.tag,AppHaxSearchResults);